role :dns_master, "ns1.adjectivism.org", "ns2.adjectivism.org"

namespace :dns do
    task :deploy, :roles => :dns_master do
        run "cd $HOME/dns ; " +
            "git remote update && " +
            "git checkout --quiet production && " +
            "git merge --no-ff --quiet origin/production && " +
            "pfexec cp *.zone /etc/bind/zones/"
    end

    task :restart, :roles => :dns_master do
        run "pfexec svcadm restart bind9"
    end
end

# vim: ft=ruby
